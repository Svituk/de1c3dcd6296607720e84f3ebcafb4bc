;(function(){
  if (window.tinymce) return;
  function textOnly(html){
    try { var div=document.createElement('div'); div.innerHTML=String(html||''); return (div.textContent||div.innerText||''); } catch(e){ return String(html||''); }
  }
  window.tinymce = {
    init: function(opts){
      var sel = opts && opts.selector ? opts.selector : 'textarea';
      var ed = {
        getContent: function(opt){
          var ta = document.querySelector(sel);
          var val = ta ? (ta.value||'') : '';
          if (opt && opt.format === 'text') return textOnly(val);
          return val;
        }
      };
      if (opts && typeof opts.setup === 'function') try { opts.setup(ed); } catch(e){}
    }
  };
})();
